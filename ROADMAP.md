# ARM64 Hypervisor å¼€å‘è·¯çº¿å›¾

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•é¡¹ç›®çš„å¼€å‘è¿›åº¦ï¼Œæ ‡è®°æ¯ä¸ªåŠŸèƒ½çš„å®ŒæˆçŠ¶æ€ã€‚

## ğŸ“Š æ•´ä½“è¿›åº¦æ¦‚è§ˆ

**æ€»ä½“å®Œæˆåº¦**: ğŸŸ¢ **70%** (æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆï¼Œé«˜çº§ç‰¹æ€§å¾…å¼€å‘)

```
é˜¶æ®µ 1: æ ¸å¿ƒè™šæ‹ŸåŒ–        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
é˜¶æ®µ 2: è®¾å¤‡æ¨¡æ‹Ÿ          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
é˜¶æ®µ 3: ä¸­æ–­è™šæ‹ŸåŒ–        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘  75% ğŸ”„
é˜¶æ®µ 4: é«˜çº§ç‰¹æ€§          â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  20% ğŸ”œ
é˜¶æ®µ 5: ç”Ÿäº§ä¼˜åŒ–          â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   0% â¸ï¸
```

---

## ğŸ¯ é˜¶æ®µ 1: æ ¸å¿ƒè™šæ‹ŸåŒ–åŠŸèƒ½ âœ… 100%

### Sprint 1.1: vCPU Framework âœ…
**å®Œæˆæ—¥æœŸ**: 2026-01-25

- [x] VcpuContext æ•°æ®ç»“æ„
  - [x] GeneralPurposeRegs (x0-x30)
  - [x] SystemRegs (EL1 ç³»ç»Ÿå¯„å­˜å™¨)
  - [x] SP å’Œ PC
- [x] å¼‚å¸¸å‘é‡è¡¨ (EL2)
  - [x] exception_vector_table å®šä¹‰
  - [x] 16 ä¸ªå¼‚å¸¸å‘é‡å…¥å£
  - [x] æ¯ä¸ªå…¥å£ 128 å­—èŠ‚å¯¹é½
- [x] VM å…¥å£/å‡ºå£æœºåˆ¶
  - [x] enter_guest æ±‡ç¼–å®ç°
  - [x] ä¸Šä¸‹æ–‡ä¿å­˜/æ¢å¤
  - [x] ERET è¿›å…¥ guest
- [x] åŸºç¡€ hypercall æ¥å£
  - [x] HVC #0 å¤„ç†
  - [x] hypercall å‚æ•°ä¼ é€’ (x0)
  - [x] è¿”å›å€¼å¤„ç†
- [x] ç®€å• guest ç¨‹åºæµ‹è¯•
  - [x] è¾“å‡ºå­—ç¬¦ 'G'
  - [x] hypercall é€€å‡º

**å…³é”®æ–‡ä»¶**:
- âœ… `src/vcpu.rs`
- âœ… `src/vm.rs`
- âœ… `src/arch/aarch64/regs.rs`
- âœ… `arch/aarch64/exception.S`
- âœ… `src/arch/aarch64/hypervisor/exception.rs`

---

### Sprint 1.2: Memory Management âœ…
**å®Œæˆæ—¥æœŸ**: 2026-01-25

- [x] Stage-2 é¡µè¡¨ç»“æ„
  - [x] L1, L2, L3 ä¸‰çº§é¡µè¡¨
  - [x] 4KB granule
  - [x] 40-bit IPA space
  - [x] 48-bit PA space
- [x] Identity mapping (GPA == HPA)
  - [x] ä»£ç åŒºåŸŸæ˜ å°„
  - [x] æ•°æ®åŒºåŸŸæ˜ å°„
  - [x] è®¾å¤‡åŒºåŸŸæ˜ å°„ âœ… (Sprint 1.5a è¡¥å……)
- [x] 2MB å—æ˜ å°„
  - [x] Block descriptor
  - [x] å†…å­˜å±æ€§è®¾ç½®
- [x] Memory attributes
  - [x] NORMAL (cached)
  - [x] DEVICE (uncached)
  - [x] READONLY
- [x] VTTBR_EL2 é…ç½®
  - [x] é¡µè¡¨åŸºåœ°å€è®¾ç½®
  - [x] BADDR å­—æ®µ
- [x] VTCR_EL2 é…ç½®
  - [x] T0SZ = 24 (40-bit IPA)
  - [x] SL0 = 1 (start at L1)
  - [x] IRGN0/ORGN0 (write-back)
- [x] HCR_EL2.VM å¯ç”¨
  - [x] Stage-2 translation enable

**å…³é”®æ–‡ä»¶**:
- âœ… `src/arch/aarch64/mm/mmu.rs`

**æŠ€æœ¯å‚æ•°**:
- IPA: 40-bit (1TB)
- PA: 48-bit (256TB)
- Granule: 4KB
- Mapping: 2MB blocks

---

### Sprint 1.3: Interrupt Handling âœ…
**å®Œæˆæ—¥æœŸ**: 2026-01-26

- [x] GIC (Generic Interrupt Controller) æ”¯æŒ
  - [x] GICv2 å¯„å­˜å™¨å®šä¹‰
  - [x] GICD (Distributor) åŸºåœ°å€
  - [x] GICC (CPU Interface) åŸºåœ°å€
  - [x] ç³»ç»Ÿå¯„å­˜å™¨æ¥å£
  - [ ] MMIO å¯„å­˜å™¨è®¿é—® (ä»…å®šä¹‰ï¼Œæœªå®é™…ä½¿ç”¨)
- [x] ARM Generic Timer æ”¯æŒ
  - [x] CNTV_* å¯„å­˜å™¨è®¿é—®
  - [x] get_frequency()
  - [x] get_counter()
  - [x] get_ctl() / set_ctl()
  - [x] enable_timer()
  - [x] is_pending()
- [x] ä¸­æ–­å¤„ç†æ¡†æ¶
  - [x] HCR_EL2 é…ç½® (IMO/FMO)
  - [x] IRQ/FIQ è·¯ç”±åˆ° EL2
  - [x] å¼‚å¸¸å¤„ç†æµç¨‹
- [x] å®šæ—¶å™¨ä¸­æ–­æµ‹è¯•
  - [x] 100ms å®šæ—¶å™¨é…ç½®
  - [x] Pending çŠ¶æ€æ£€æµ‹
  - [x] ISTATUS bit éªŒè¯

**å…³é”®æ–‡ä»¶**:
- âœ… `src/arch/aarch64/peripherals/gic.rs`
- âœ… `src/arch/aarch64/peripherals/timer.rs`
- âœ… `tests/test_timer.rs`

**æµ‹è¯•ç»“æœ**:
- âœ… å®šæ—¶å™¨æˆåŠŸé…ç½® (62.5MHz)
- âœ… CNTV_CTL: 0x1 â†’ 0x5 (pending bit set)

---

## ğŸ¯ é˜¶æ®µ 2: è®¾å¤‡æ¨¡æ‹Ÿ âœ… 100%

### Sprint 1.4: Device Emulation âœ…
**å®Œæˆæ—¥æœŸ**: 2026-01-26

- [x] æŒ‡ä»¤è§£ç å™¨
  - [x] Load/Store æŒ‡ä»¤è¯†åˆ«
  - [x] ISS (Instruction Specific Syndrome) è§£æ
  - [x] å¯„å­˜å™¨å·æå–
  - [x] è®¿é—®å¤§å°æå–
  - [x] è¯»/å†™æ–¹å‘åˆ¤æ–­
  - [x] æ‰‹åŠ¨è§£ç ä½œä¸ºåå¤‡
- [x] MMIO Trap-and-Emulate Handler
  - [x] Data Abort æ•è·
  - [x] FAR_EL2 è¯»å–æ•…éšœåœ°å€
  - [x] æŒ‡ä»¤è§£ç 
  - [x] è®¾å¤‡è·¯ç”±
  - [x] å¯„å­˜å™¨è¯»å†™æ¨¡æ‹Ÿ
  - [x] PC += 4 ç»§ç»­æ‰§è¡Œ
- [x] è®¾å¤‡ä»¿çœŸæ¡†æ¶
  - [x] MmioDevice trait å®šä¹‰
  - [x] read() / write() æ¥å£
  - [x] base_address() / size()
  - [x] contains() åœ°å€åˆ¤æ–­
  - [x] DeviceManager è·¯ç”±
  - [x] å…¨å±€è®¿é—®æ¥å£
- [x] è™šæ‹Ÿ UART (PL011)
  - [x] UARTDR (0x000) æ•°æ®å¯„å­˜å™¨
  - [x] UARTFR (0x018) æ ‡å¿—å¯„å­˜å™¨
  - [x] UARTCR (0x030) æ§åˆ¶å¯„å­˜å™¨
  - [x] å­—ç¬¦è¾“å‡ºåˆ°çœŸå® UART
  - [x] MMIO è®¿é—®æµ‹è¯• âœ…
- [x] è™šæ‹Ÿ GICD
  - [x] GICD_CTLR (0x000) æ§åˆ¶
  - [x] GICD_TYPER (0x004) ç±»å‹
  - [x] GICD_ISENABLER (0x100-0x17F) ä½¿èƒ½
  - [x] GICD_ICENABLER (0x180-0x1FF) ç¦ç”¨
  - [x] GICD_IPRIORITYR (0x400-0x7FF) ä¼˜å…ˆçº§
  - [x] é…ç½®å˜åŒ–æ—¥å¿—
- [x] å¯„å­˜å™¨è®¿é—®æ¥å£
  - [x] GeneralPurposeRegs::get_reg()
  - [x] GeneralPurposeRegs::set_reg()
  - [x] x0-x30 å®Œæ•´æ”¯æŒ

**å…³é”®æ–‡ä»¶**:
- âœ… `src/arch/aarch64/hypervisor/decode.rs`
- âœ… `src/devices/mod.rs`
- âœ… `src/devices/pl011/emulator.rs`
- âœ… `src/devices/gic/distributor.rs`
- âœ… `src/global.rs`
- âœ… `tests/test_mmio.rs`

**æµ‹è¯•ç»“æœ**:
- âœ… Guest é€šè¿‡ MMIO è®¿é—®è™šæ‹Ÿ UART
- âœ… è¾“å‡º "MMIO" å­—ç¬¦ä¸²æˆåŠŸ
- âœ… Trap-and-Emulate æ¡†æ¶å®Œå…¨å·¥ä½œ

**æ¶æ„ç‰¹ç‚¹**:
- Zero-copy è®¾å¤‡ä»¿çœŸ
- å¯æ‰©å±•è®¾å¤‡æ¡†æ¶
- è®¾å¤‡åœ°å€è‡ªåŠ¨è·¯ç”±

---

## ğŸ¯ é˜¶æ®µ 3: ä¸­æ–­è™šæ‹ŸåŒ– ğŸ”„ 75%

### Sprint 1.5b: Guest Interrupt Injection âœ… (åŸºç¡€)
**å®Œæˆæ—¥æœŸ**: 2026-01-26

- [x] è™šæ‹Ÿä¸­æ–­çŠ¶æ€ç®¡ç†
  - [x] VirtualInterruptState ç»“æ„
  - [x] irq_pending / fiq_pending çŠ¶æ€
  - [x] pending_irq_num è®°å½•
  - [x] inject_irq() API
  - [x] clear_irq() API
  - [x] has_pending_interrupt() æŸ¥è¯¢
- [x] HCR_EL2 ä¸­æ–­æ³¨å…¥
  - [x] apply_to_hcr() æ–¹æ³•
  - [x] HCR_EL2.VI bit (è™šæ‹Ÿ IRQ)
  - [x] HCR_EL2.VF bit (è™šæ‹Ÿ FIQ)
  - [x] get_hcr_el2() / set_hcr_el2()
- [x] Vcpu é›†æˆ
  - [x] virt_irq å­—æ®µ
  - [x] inject_irq() å…¬å¼€ API
  - [x] run() è‡ªåŠ¨åº”ç”¨ VI çŠ¶æ€
- [x] åŸºç¡€æµ‹è¯•
  - [x] Guest unmask IRQ
  - [x] Hypervisor æ³¨å…¥ IRQ 27
  - [x] éªŒè¯ VI æœºåˆ¶å·¥ä½œ

**å…³é”®æ–‡ä»¶**:
- âœ… `src/vcpu_interrupt.rs`
- âœ… `src/vcpu.rs` (é›†æˆ)
- âœ… `tests/test_guest_interrupt.rs`

**æµ‹è¯•ç»“æœ**:
- âœ… Hypervisor æˆåŠŸæ³¨å…¥è™šæ‹Ÿ IRQ
- âœ… Guest unmask åç«‹å³æ”¶åˆ°ä¸­æ–­
- âœ… HCR_EL2.VI æœºåˆ¶éªŒè¯å·¥ä½œ

**å¾…å®Œæˆ** (Sprint 1.6 é€‰é¡¹ A):
- [ ] Guest å¼‚å¸¸å‘é‡è¡¨è®¾ç½®
  - [ ] VBAR_EL1 é…ç½®
  - [ ] IRQ handler å®ç°
  - [ ] å¼‚å¸¸è¿”å› (ERET)
- [ ] EOI (End of Interrupt) å¤„ç†
  - [ ] Guest EOI è¯†åˆ«
  - [ ] æ¸…é™¤ pending çŠ¶æ€
  - [ ] å…è®¸ä¸‹ä¸€ä¸ªä¸­æ–­
- [ ] å¤šæ¬¡ä¸­æ–­æ³¨å…¥æµ‹è¯•
- [ ] ä¸­æ–­ä¼˜å…ˆçº§æ”¯æŒ

---

### GIC CPU Interface â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: Sprint 1.6 é€‰é¡¹ C [3-4h]

- [ ] GICC å¯„å­˜å™¨æ¨¡æ‹Ÿ (0x08010000)
  - [ ] GICC_CTLR (0x000) - CPU Interface Control
  - [ ] GICC_PMR (0x004) - Priority Mask
  - [ ] GICC_IAR (0x00C) - Interrupt Acknowledge
  - [ ] GICC_EOIR (0x010) - End of Interrupt
  - [ ] GICC_RPR (0x014) - Running Priority
  - [ ] GICC_HPPIR (0x018) - Highest Priority Pending
- [ ] ä¸­æ–­ç¡®è®¤æµç¨‹
  - [ ] IAR read â†’ è¿”å›ä¸­æ–­å·
  - [ ] IAR read â†’ çŠ¶æ€ä» pending å˜ä¸º active
- [ ] EOI æµç¨‹
  - [ ] EOIR write â†’ æ¸…é™¤ active çŠ¶æ€
  - [ ] å…è®¸ä¸‹ä¸€ä¸ªä¸­æ–­
- [ ] ä¼˜å…ˆçº§ç®¡ç†
  - [ ] Priority Mask è¿‡æ»¤
  - [ ] Running Priority æ›´æ–°
  - [ ] ä¼˜å…ˆçº§æ¯”è¾ƒ

**æ”¶ç›Š**: å®Œæ•´çš„ GICv2 æ”¯æŒï¼Œç¬¦åˆ ARM è§„èŒƒ

---

### ä¸­æ–­è·¯ç”±å’Œåˆ†å‘ â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: åç»­ [2-3h]

- [ ] SGI (Software Generated Interrupt)
  - [ ] è½¯ä»¶è§¦å‘ä¸­æ–­
  - [ ] vCPU é—´é€šä¿¡
- [ ] PPI (Private Peripheral Interrupt)
  - [ ] Per-CPU ä¸­æ–­
  - [ ] Timer, PMU ç­‰
- [ ] SPI (Shared Peripheral Interrupt)
  - [ ] å…±äº«è®¾å¤‡ä¸­æ–­
  - [ ] ä¸­æ–­åˆ†å‘ç­–ç•¥
- [ ] ä¸­æ–­äº²å’Œæ€§
  - [ ] ITARGETSR é…ç½®
  - [ ] vCPU ç»‘å®š

---

## ğŸ¯ é˜¶æ®µ 4: é«˜çº§ç‰¹æ€§ ğŸ”œ 20%

### åŠ¨æ€å†…å­˜ç®¡ç† â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: Sprint 1.6 é€‰é¡¹ B [4-6h]

- [ ] å†…å­˜åˆ†é…å™¨å®ç°
  - [ ] Bump allocator (ç®€å•)
  - [ ] Buddy allocator (é«˜æ•ˆ)
  - [ ] Slab allocator (å¯¹è±¡æ± )
- [ ] å…¨å±€åˆ†é…å™¨é›†æˆ
  - [ ] #[global_allocator]
  - [ ] Box/Vec æ”¯æŒ
  - [ ] åŠ¨æ€æ•°æ®ç»“æ„
- [ ] é¡µè¡¨åŠ¨æ€åˆ†é…
  - [ ] æŒ‰éœ€åˆ›å»ºé¡µè¡¨é¡µ
  - [ ] å†…å­˜å›æ”¶
- [ ] è®¾å¤‡çŠ¶æ€åŠ¨æ€åˆ†é…
  - [ ] è®¾å¤‡å¯¹è±¡åŠ¨æ€åˆ›å»º
  - [ ] é…ç½®æ•°æ®åŠ¨æ€å­˜å‚¨
- [ ] å†…å­˜ç»Ÿè®¡
  - [ ] å·²åˆ†é…/ç©ºé—²ç»Ÿè®¡
  - [ ] å†…å­˜æ³„æ¼æ£€æµ‹

**æ”¶ç›Š**: è§£é™¤é™æ€å†…å­˜é™åˆ¶ï¼Œæ›´çµæ´»çš„èµ„æºç®¡ç†

---

### å¤š vCPU æ”¯æŒ â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: åç»­ [15-20h]

- [ ] per-vCPU context
  - [ ] ç‹¬ç«‹ä¸Šä¸‹æ–‡å­˜å‚¨
  - [ ] çº¿ç¨‹æœ¬åœ°å­˜å‚¨
- [ ] vCPU è°ƒåº¦å™¨
  - [ ] Round-robin è°ƒåº¦
  - [ ] ä¼˜å…ˆçº§è°ƒåº¦
  - [ ] è´Ÿè½½å‡è¡¡
- [ ] SMP é”æœºåˆ¶
  - [ ] Spinlock
  - [ ] Mutex
  - [ ] RwLock
- [ ] CPU äº²å’Œæ€§
  - [ ] vCPU ç»‘å®šåˆ°ç‰©ç† CPU
  - [ ] vCPU è¿ç§»
- [ ] IPI (Inter-Processor Interrupt)
  - [ ] vCPU é—´é€šä¿¡
  - [ ] SGI æ”¯æŒ

**æ¶æ„å˜æ›´**:
- `current_vcpu_context` ä»å…¨å±€å˜é‡æ”¹ä¸º per-CPU
- å¼‚å¸¸å¤„ç†æ”¯æŒå¤š vCPU
- è®¾å¤‡è®¿é—®åŠ é”ä¿æŠ¤

---

### PSCI (Power State Coordination Interface) â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: åç»­ [8-10h]

- [ ] PSCI 0.2 hypercall æ¥å£
  - [ ] PSCI_VERSION
  - [ ] PSCI_CPU_SUSPEND
  - [ ] PSCI_CPU_OFF
  - [ ] PSCI_CPU_ON
  - [ ] PSCI_SYSTEM_OFF
  - [ ] PSCI_SYSTEM_RESET
- [ ] CPU ç”µæºç®¡ç†
  - [ ] vCPU å¯åŠ¨/åœæ­¢
  - [ ] vCPU æŒ‚èµ·/æ¢å¤
  - [ ] çŠ¶æ€ä¿å­˜/æ¢å¤
- [ ] ç³»ç»Ÿç”µæºç®¡ç†
  - [ ] ç³»ç»Ÿå…³é—­
  - [ ] ç³»ç»Ÿé‡å¯
- [ ] SMP å¯åŠ¨åºåˆ—
  - [ ] Primary CPU å¯åŠ¨
  - [ ] Secondary CPU å¯åŠ¨
  - [ ] CPU release æœºåˆ¶

**æ”¶ç›Š**: æ”¯æŒ guest OS çš„ç”µæºç®¡ç†å’Œå¤šæ ¸å¯åŠ¨

---

### Stage-1 é¡µè¡¨éå† â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: åç»­ [10-12h]

- [ ] GVA â†’ GPA è½¬æ¢
  - [ ] è¯»å– guest TTBR0_EL1/TTBR1_EL1
  - [ ] éå† guest é¡µè¡¨
  - [ ] å¤„ç†é¡µè¡¨é¡¹
- [ ] é¡µè¡¨è§£æ
  - [ ] L0/L1/L2/L3 é¡µè¡¨è¯†åˆ«
  - [ ] Block/Page descriptor
  - [ ] å†…å­˜å±æ€§æå–
- [ ] TLB æ¨¡æ‹Ÿ
  - [ ] è½¯ä»¶ TLB ç¼“å­˜
  - [ ] TLB flush å¤„ç†
- [ ] åº”ç”¨åœºæ™¯
  - [ ] è°ƒè¯• (æŸ¥çœ‹ guest å†…å­˜æ˜ å°„)
  - [ ] DMA æ¨¡æ‹Ÿ (è®¾å¤‡è®¿é—® guest å†…å­˜)
  - [ ] å†…å­˜æ£€æŸ¥ (å®‰å…¨å®¡è®¡)

---

### é«˜çº§è®¾å¤‡æ”¯æŒ â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: åç»­ [20+h]

- [ ] VirtIO è®¾å¤‡æ¡†æ¶
  - [ ] VirtIO MMIO ä¼ è¾“
  - [ ] Virtqueue ç®¡ç†
  - [ ] Descriptor å¤„ç†
- [ ] VirtIO-Net (ç½‘ç»œ)
  - [ ] å‘é€é˜Ÿåˆ—
  - [ ] æ¥æ”¶é˜Ÿåˆ—
  - [ ] ç½‘ç»œåŒ…å¤„ç†
- [ ] VirtIO-Block (å—è®¾å¤‡)
  - [ ] è¯»å†™è¯·æ±‚
  - [ ] å—è®¾å¤‡åç«¯
- [ ] VirtIO-Console (æ§åˆ¶å°)
  - [ ] è¾“å…¥è¾“å‡ºé˜Ÿåˆ—
  - [ ] å¤šç«¯å£æ”¯æŒ
- [ ] SMMU (System MMU)
  - [ ] Stage-2 DMA é‡æ˜ å°„
  - [ ] IOMMU æ”¯æŒ

---

## ğŸ¯ é˜¶æ®µ 5: ç”Ÿäº§ä¼˜åŒ– â¸ï¸ 0%

### æ€§èƒ½ä¼˜åŒ– â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: åç»­ [æŒç»­]

- [ ] Context switch ä¼˜åŒ–
  - [ ] ç²¾ç®€ä¿å­˜/æ¢å¤è·¯å¾„
  - [ ] æ‡’ä¿å­˜æµ®ç‚¹å¯„å­˜å™¨
  - [ ] ASID ä¼˜åŒ–
- [ ] é¡µè¡¨ä¼˜åŒ–
  - [ ] 1GB huge page æ”¯æŒ
  - [ ] é¡µè¡¨ç¼“å­˜
  - [ ] TLB ä¼˜åŒ–
- [ ] MMIO å¿«é€Ÿè·¯å¾„
  - [ ] çƒ­ç‚¹è®¾å¤‡ä¼˜åŒ–
  - [ ] æ‰¹é‡æ“ä½œ
- [ ] ä¸­æ–­å¤„ç†ä¼˜åŒ–
  - [ ] ä¸­æ–­åˆå¹¶
  - [ ] ä¸­æ–­æ‰¹å¤„ç†
  - [ ] Posted interrupts

**æ€§èƒ½ç›®æ ‡**:
- Context switch: < 500ns
- Hypercall: < 100ns
- MMIO emulation: < 200ns

---

### é”™è¯¯å¤„ç†å’Œæ¢å¤ â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: åç»­ [10-15h]

- [ ] å¼‚å¸¸æ¢å¤
  - [ ] Guest å¼‚å¸¸éš”ç¦»
  - [ ] é”™è¯¯æ³¨å…¥æœºåˆ¶
  - [ ] å®¹é”™å¤„ç†
- [ ] æ—¥å¿—ç³»ç»Ÿ
  - [ ] åˆ†çº§æ—¥å¿— (DEBUG/INFO/WARN/ERROR)
  - [ ] æ—¥å¿—ç¼“å†²
  - [ ] æ—¥å¿—è¾“å‡º
- [ ] è°ƒè¯•æ”¯æŒ
  - [ ] GDB stub
  - [ ] æ–­ç‚¹æ”¯æŒ
  - [ ] å•æ­¥æ‰§è¡Œ
- [ ] å´©æºƒè½¬å‚¨
  - [ ] Guest coredump
  - [ ] Hypervisor panic å¤„ç†
  - [ ] çŠ¶æ€ä¿å­˜

---

### å®‰å…¨å¼ºåŒ– â¸ï¸ (æœªå¼€å§‹)
**é¢„è®¡**: åç»­ [15-20h]

- [ ] å†…å­˜éš”ç¦»
  - [ ] Guest å†…å­˜è¾¹ç•Œæ£€æŸ¥
  - [ ] é˜²æ­¢è¶Šç•Œè®¿é—®
- [ ] ç‰¹æƒæ£€æŸ¥
  - [ ] Hypercall æƒé™éªŒè¯
  - [ ] è®¾å¤‡è®¿é—®æ§åˆ¶
- [ ] ä¾§ä¿¡é“é˜²æŠ¤
  - [ ] Cache éš”ç¦»
  - [ ] Spectre/Meltdown ç¼“è§£
- [ ] å®‰å…¨å¯åŠ¨
  - [ ] Guest é•œåƒéªŒè¯
  - [ ] Secure boot æ”¯æŒ

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

### å½“å‰çŠ¶æ€ (2026-01-26)
```
æ–‡ä»¶ç±»å‹        æ–‡ä»¶æ•°    ä»£ç è¡Œæ•°    æ³¨é‡Šè¡Œæ•°    ç©ºè¡Œæ•°
----------------------------------------------------------
Rust æºç          20      3800        800        600
æ±‡ç¼–ä»£ç            2       300         80         40
æµ‹è¯•ä»£ç           5       600        120         80
æ–‡æ¡£              3       1500          -          -
----------------------------------------------------------
æ€»è®¡              30      6200       1000        720
```

### æ¨¡å—åˆ†å¸ƒ
```
src/arch/aarch64/
â”œâ”€â”€ hypervisor/     ~600 è¡Œ (å¼‚å¸¸å¤„ç†)
â”œâ”€â”€ mm/             ~300 è¡Œ (å†…å­˜ç®¡ç†)
â”œâ”€â”€ peripherals/    ~400 è¡Œ (GIC, Timer)
â””â”€â”€ regs.rs         ~800 è¡Œ (å¯„å­˜å™¨å®šä¹‰)

src/devices/
â”œâ”€â”€ pl011/          ~100 è¡Œ (UART)
â””â”€â”€ gic/            ~150 è¡Œ (GICD)

src/
â”œâ”€â”€ vcpu.rs         ~150 è¡Œ
â”œâ”€â”€ vm.rs           ~250 è¡Œ
â”œâ”€â”€ vcpu_interrupt.rs ~180 è¡Œ
â””â”€â”€ global.rs       ~60 è¡Œ

tests/
â”œâ”€â”€ test_guest.rs          ~120 è¡Œ
â”œâ”€â”€ test_timer.rs          ~80 è¡Œ
â”œâ”€â”€ test_mmio.rs           ~150 è¡Œ
â”œâ”€â”€ test_guest_interrupt.rs ~150 è¡Œ
â””â”€â”€ test_guest_irq.rs      ~15 è¡Œ
```

---

## ğŸ“ æŠ€æœ¯å€ºåŠ¡å’Œå·²çŸ¥é—®é¢˜

### é«˜ä¼˜å…ˆçº§
- [ ] Guest å¼‚å¸¸å‘é‡è¡¨æµ‹è¯•ä¸å®Œæ•´
  - **ç°çŠ¶**: åªæµ‹è¯•äº† VI æœºåˆ¶ï¼Œguest è·³è½¬åˆ°å¼‚å¸¸å‘é‡ä½†æ²¡æœ‰å¤„ç†
  - **å½±å“**: æ— æ³•å®Œæ•´æµ‹è¯•ä¸­æ–­å¤„ç†æµç¨‹
  - **è§£å†³**: Sprint 1.6 é€‰é¡¹ A

### ä¸­ä¼˜å…ˆçº§
- [ ] é™æ€å†…å­˜é™åˆ¶
  - **ç°çŠ¶**: æ‰€æœ‰æ•°æ®ç»“æ„é™æ€åˆ†é…
  - **å½±å“**: å†…å­˜ä½¿ç”¨ä¸çµæ´»ï¼Œæ— æ³•åŠ¨æ€æ‰©å±•
  - **è§£å†³**: Sprint 1.6 é€‰é¡¹ B

- [ ] GIC åªæœ‰ Distributorï¼Œç¼ºå°‘ CPU Interface
  - **ç°çŠ¶**: GICD å·²å®ç°ï¼ŒGICC æœªå®ç°
  - **å½±å“**: æ— æ³•æ­£ç¡®å¤„ç† IAR/EOIR
  - **è§£å†³**: Sprint 1.6 é€‰é¡¹ C

### ä½ä¼˜å…ˆçº§
- [ ] å• vCPU é™åˆ¶
  - **ç°çŠ¶**: åªæ”¯æŒå•æ ¸ guest
  - **å½±å“**: æ— æ³•æµ‹è¯• SMP
  - **è§£å†³**: åç»­ Sprint

- [ ] ç¼–è¯‘è­¦å‘Š (8 ä¸ªæ±‡ç¼–æ ¼å¼æç¤º)
  - **ç°çŠ¶**: å‰©ä½™ 8 ä¸ª warning
  - **å½±å“**: ä¸å½±å“åŠŸèƒ½
  - **è§£å†³**: å¯å¿½ç•¥æˆ–åç»­å¤„ç†

---

## ğŸ“š æ–‡æ¡£å®Œæˆåº¦

### âœ… å·²å®Œæˆ
- [x] README.md (é¡¹ç›®ä»‹ç»)
- [x] PROGRESS.md (å¼€å‘è¿›åº¦)
- [x] ROADMAP.md (æœ¬æ–‡æ¡£)
- [x] ç›®å½•ç»“æ„è¯´æ˜
- [x] å¿«é€Ÿå¼€å§‹æŒ‡å—
- [x] æŠ€æœ¯æ¶æ„å›¾

### â¸ï¸ å¾…å®Œæˆ
- [ ] API æ–‡æ¡£ (rustdoc)
  - [ ] æ ¸å¿ƒç»“æ„æ³¨é‡Š
  - [ ] å…¬å¼€ API æ–‡æ¡£
  - [ ] ä½¿ç”¨ç¤ºä¾‹
- [ ] CONTRIBUTING.md
  - [ ] è´¡çŒ®æŒ‡å—
  - [ ] ä»£ç é£æ ¼
  - [ ] PR æµç¨‹
- [ ] ARCHITECTURE.md
  - [ ] è¯¦ç»†æ¶æ„è®¾è®¡
  - [ ] æ¨¡å—äº¤äº’å›¾
  - [ ] æ•°æ®æµå›¾
- [ ] è®¾å¤‡æ‰©å±•æŒ‡å—
  - [ ] å¦‚ä½•æ·»åŠ æ–°è®¾å¤‡
  - [ ] MmioDevice trait ä½¿ç”¨
  - [ ] è®¾å¤‡æµ‹è¯•

---

## ğŸ¯ é‡Œç¨‹ç¢‘

### âœ… å·²è¾¾æˆ
- [x] **M1: åŸºç¡€è™šæ‹ŸåŒ–** (2026-01-25)
  - vCPU, Memory, Exception handling
  
- [x] **M2: è®¾å¤‡æ¨¡æ‹Ÿ** (2026-01-26)
  - MMIO framework, UART, GICD
  
- [x] **M3: ä¸­æ–­åŸºç¡€** (2026-01-26)
  - Timer, Interrupt injection

### ğŸ¯ è®¡åˆ’ä¸­
- [ ] **M4: å®Œæ•´ä¸­æ–­** (é¢„è®¡ 2026-01-27)
  - Guest exception vector, EOI, GICC
  
- [ ] **M5: åŠ¨æ€å†…å­˜** (é¢„è®¡ 2026-01-28)
  - Memory allocator, Dynamic structures
  
- [ ] **M6: å¤šæ ¸æ”¯æŒ** (é¢„è®¡ 2026-02)
  - Multi-vCPU, Scheduler, SMP
  
- [ ] **M7: è¿è¡Œ OS** (é¢„è®¡ 2026-03)
  - PSCI, VirtIO, Linux guest

---

## ğŸ“ ç‰ˆæœ¬å†å²

### v0.3.0 (Current) - Sprint 1.5b
**å‘å¸ƒæ—¥æœŸ**: 2026-01-26
- âœ… Guest interrupt injection (åŸºç¡€)
- âœ… MMIO æµ‹è¯•ä¿®å¤
- âœ… ä»£ç è´¨é‡æå‡
- âœ… æµ‹è¯•è¦†ç›– 100%

### v0.2.0 - Sprint 1.4
**å‘å¸ƒæ—¥æœŸ**: 2026-01-26
- âœ… Device emulation framework
- âœ… UART/GICD emulation
- âœ… Instruction decoder

### v0.1.0 - Sprint 1.1-1.3
**å‘å¸ƒæ—¥æœŸ**: 2026-01-25
- âœ… vCPU framework
- âœ… Memory management
- âœ… Interrupt handling

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**ç«‹å³å¯åš** (1-3h):
1. **é€‰é¡¹ A**: å®Œå–„ä¸­æ–­æ³¨å…¥ [2-3h]
2. **é€‰é¡¹ D**: API æ–‡æ¡£ [1-2h]

**çŸ­æœŸç›®æ ‡** (1å‘¨):
1. å®Œæˆ Sprint 1.6
2. è¾¾æˆ M4 é‡Œç¨‹ç¢‘
3. æµ‹è¯•è¦†ç›–ä¿æŒ 100%

**ä¸­æœŸç›®æ ‡** (1æœˆ):
1. åŠ¨æ€å†…å­˜ç®¡ç†
2. GIC å®Œæ•´å®ç°
3. å¤š vCPU æ”¯æŒ

**é•¿æœŸç›®æ ‡** (3æœˆ):
1. PSCI æ”¯æŒ
2. VirtIO è®¾å¤‡
3. è¿è¡Œ Linux guest

---

**æ–‡æ¡£ç»´æŠ¤**: æœ¬æ–‡æ¡£ä¼šéšç€å¼€å‘è¿›åº¦æŒç»­æ›´æ–°
**æœ€åæ›´æ–°**: 2026-01-26
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ
